import{r as f,u as h,d as R,E as b,I as C,j as S,k as $,l as _,m as t,q as s,D as x,s as l,t as g,H as k,v as A,y as w,A as B,_ as E}from"./index-D4LJPWFD.js";function N(){const m=f(""),n=f(""),r=f(""),o=f(""),p=f(!1),u=R(),c=h();return{email:n,handleRegister:async()=>{if(!m.value.trim()||!r.value){o.value="用户名和密码必填",b.warning(o.value);return}p.value=!0;try{const e=await C(m.value.trim(),r.value,n.value.trim()),i=e.data?.data??e.data,d=i?.token,v=i?.username;if(!e.ok||!d){o.value=e.data?.message||"注册失败",b.error(o.value);return}c.setAuth(d,v||m.value.trim()),u.push({name:"home"})}catch{o.value="注册失败，请稍后重试",b.error(o.value)}finally{p.value=!1}},loading:p,message:o,password:r,router:u,username:m}}const U={class:"page"},D={class:"card"},I={class:"msg"},M={class:"actions"},j={class:"actions-vertical"},q=S({__name:"RegisterView",setup(m){const{email:n,handleRegister:r,loading:o,message:p,password:u,username:c}=N();return(V,e)=>{const i=g("el-input"),d=g("el-form-item"),v=g("el-button"),y=g("el-form");return B(),$("div",U,[_("div",D,[t(y,{onSubmit:x(l(r),["prevent"])},{default:s(()=>[t(d,{label:"用户名"},{default:s(()=>[t(i,{modelValue:l(c),"onUpdate:modelValue":e[0]||(e[0]=a=>k(c)?c.value=a:null),placeholder:"请输入用户名",autocomplete:"username"},null,8,["modelValue"])]),_:1}),t(d,{label:"邮箱"},{default:s(()=>[t(i,{modelValue:l(n),"onUpdate:modelValue":e[1]||(e[1]=a=>k(n)?n.value=a:null),type:"email",placeholder:"请输入邮箱",autocomplete:"email"},null,8,["modelValue"])]),_:1}),t(d,{label:"密码"},{default:s(()=>[t(i,{modelValue:l(u),"onUpdate:modelValue":e[2]||(e[2]=a=>k(u)?u.value=a:null),type:"password",placeholder:"请输入密码",autocomplete:"new-password"},null,8,["modelValue"])]),_:1}),_("div",I,A(l(p)),1),_("div",M,[t(v,{type:"primary",loading:l(o),class:"btn",onClick:l(r),block:""},{default:s(()=>[...e[5]||(e[5]=[w("注册",-1)])]),_:1},8,["loading","onClick"]),_("div",j,[t(v,{class:"btn-ghost",block:"",onClick:e[3]||(e[3]=a=>V.$router.push({name:"login"}))},{default:s(()=>[...e[6]||(e[6]=[w("已有账号？去登录",-1)])]),_:1}),t(v,{class:"btn-ghost",block:"",onClick:e[4]||(e[4]=a=>V.$router.push({name:"home"}))},{default:s(()=>[...e[7]||(e[7]=[w("返回首页",-1)])]),_:1})])])]),_:1},8,["onSubmit"])])])}}}),T=E(q,[["__scopeId","data-v-c6c4f784"]]);export{T as default};
